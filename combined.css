:root{
  --bg:#fdf5e6; --ink:#222; --brand:#f5a623; --frame:#e6a937; --paper:#fffbee;
  --muted:#6b6b6b; --ok:#1a8d2b; --warn:#b35b0e; --bad:#b3260e;
}
*{box-sizing:border-box}
html,body{margin:0;height:100%}
body{font-family:"Comic Sans MS", system-ui, -apple-system, Segoe UI, sans-serif; background:var(--bg); color:var(--ink)}

/* Topbar */
#topbar{position:sticky; top:0; z-index:1000; display:flex; align-items:center; justify-content:space-between; gap:12px; padding:.5rem 1rem; background:#fdd26e; border-bottom:2px solid var(--frame)}
#topbar .left{display:flex; align-items:center; gap:10px}
#topbar .right{display:flex; align-items:center; gap:10px; font-weight:600}
#topbar .brand{font-weight:700}
#topbar .sep{opacity:.6}
#topbar .btn{background:var(--brand); border:0; color:#000; padding:.35rem .6rem; border-radius:8px; cursor:pointer}
#topbar .btn:hover{filter:brightness(.95)}
#topbar .speed{display:flex; align-items:center; gap:6px}
.speed-btn{background:#fff3c8}
.speed-btn.active{outline:2px solid #000}

/* Layout */
.layout{display:grid; grid-template-columns:310px 1fr 320px; gap:12px; padding:12px; min-height:calc(100vh - 56px)}
aside{background:rgba(255,255,255,.85); border:2px solid var(--frame); border-radius:12px; padding:12px}
#center{position:relative; border:2px solid var(--frame); border-radius:12px; background:var(--paper); overflow:hidden}

h3{margin:6px 0 8px}
.row{display:flex; gap:8px; align-items:center; margin:.35rem 0; flex-wrap:wrap}
.grid{display:grid; grid-template-columns:1fr 1fr; gap:8px}
label{font-size:.95rem}
input[type="number"], input[type="time"], input[type="range"], select{padding:.35rem .5rem; border:1px solid #d3b37a; border-radius:8px; background:#fff}
.btn.wide{width:100%}
.hint{font-size:.85rem; color:#444}
.small{font-size:.9rem}
.muted{color:#666}
hr{border:0;border-top:1px dashed #d3b37a;margin:.6rem 0}

/* Scene artwork (from joc1) */
.scene{position:absolute; inset:0; background:url('shop_background.png') center/cover no-repeat}
.scene.scene-shop{background-image:url('shop_background.png')}
.scene.scene-kitchen{background-image:url('kitchen_background.png')}
.scene.scene-worktop{background-image:url('worktop_background.png')}
.order-ticket{position:absolute; top:.5rem; right:.5rem; background:var(--paper); border:2px solid var(--frame); padding:.4rem .7rem; border-radius:8px; font-weight:bold}

/* Banisor */
.banisor-counter{position:absolute; bottom:1rem; left:1rem; text-align:center}
.banisor-sprite{width:120px;height:120px;display:inline-block}
.banisor-sprite svg{width:100%;height:100%;display:block}
.banisor-sprite .hand-wave{transform-box:fill-box;transform-origin:left center;animation:hand-wave 2s ease-in-out infinite}
@keyframes hand-wave{0%,100%{transform:rotate(0)}25%{transform:rotate(18deg)}50%{transform:rotate(-10deg)}75%{transform:rotate(14deg)}}
.banisor-sprite .eye{transform-box:fill-box;transform-origin:center;animation:blink 4.5s infinite}
@keyframes blink{0%,92%,100%{transform:scaleY(1)}94%{transform:scaleY(.05)}96%{transform:scaleY(1)}}
.banisor-sprite .hat{transform-box:fill-box;transform-origin:center;animation:hat-bob 2s ease-in-out infinite}
@keyframes hat-bob{0%,100%{transform:translateY(0) rotate(0)}50%{transform:translateY(-1.5px) rotate(-3deg)}}

/* Right metrics */
#right-metrics .metric{margin:.6rem 0}
#right-metrics .label{font-size:.9rem;margin-bottom:.25rem}
.bar{height:12px; background:#eee; border-radius:6px; overflow:hidden; border:1px solid #ccc}
.bar>span{display:block;height:100%;background:#69c56f}
.bar.warn>span{background:#f2b75f}
.bar.bad>span{background:#e06a5f}
.panel.soft{background:#fffbee;border:1px dashed var(--frame);border-radius:10px;padding:8px}
.row.tight{justify-content:space-between}

/* Station bar */
#stationbar{position:fixed; bottom:0; left:0; width:100%; display:flex; justify-content:center; gap:1rem; padding:.4rem; background:#333; color:#fff; font-size:.9rem}
#stationbar .station{padding:.3rem .9rem; background:#555; border-radius:6px}
#stationbar .station.active{background:var(--brand); color:#000}

/* Modals */
.modal-overlay{position:fixed; inset:0; background:rgba(0,0,0,.45); display:flex; align-items:center; justify-content:center; z-index:9999}
.modal-overlay[hidden]{display:none !important}
.modal{width:min(720px,92%); background:var(--paper); border:3px solid var(--frame); border-radius:12px; padding:1rem 1.2rem; box-shadow:0 12px 28px rgba(0,0,0,.22)}
.modal.wide{width:min(960px,96%)}
.modal h2{margin:.2rem 0 .5rem}
.modal ul{margin:.4rem 0 .6rem 1.2rem}
.modal .footer{display:flex; justify-content:space-between; align-items:center; margin-top:.6rem}

/* Arcade oven */
.oven-animation-container{position:relative;width:420px;height:300px;margin:1rem auto}
.oven-image{position:absolute;inset:0;width:100%;height:100%}
.baking-tray{position:absolute;width:280px;height:150px;background:#c0c0c0;border:2px solid #8b8b8b;border-radius:8px;display:flex;justify-content:center;align-items:center;top:100px;left:-290px;animation:bake-animation 3s ease-in-out forwards;opacity:1;transition:opacity .2s}
.cookie-on-tray{width:100px;height:100px}
@keyframes bake-animation{0%{transform:translateX(0)}20%{transform:translateX(410px)}80%{transform:translateX(410px)}100%{transform:translateX(0)}}
.progress-container{width:60%;height:20px;background:var(--paper);border:2px solid var(--frame);border-radius:10px;margin:1rem auto}
.progress-bar{height:100%;width:0;background:var(--brand);border-radius:10px;transition:width .1s}
.hit-window{width:60%;height:16px;border:1px dashed #999;margin:0 auto;border-radius:10px;position:relative}
.hit-window span{position:absolute;left:55%;width:10%;height:100%;background:#88d18a;opacity:.45;border-radius:10px}

/* Intro */
.overlay-intro{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(253,245,230,.88);backdrop-filter:saturate(1.2)}

/* Prep (ingredients) */
.prep-root{display:grid;grid-template-columns:280px 1fr 280px;gap:12px;margin-top:.4rem}
.prep-palette{background:#fff;border:2px dashed var(--frame);border-radius:10px;padding:8px;display:grid;grid-template-columns:1fr 1fr;gap:8px;align-content:start;max-height:420px;overflow:auto}
.ingredient-btn{display:flex;align-items:center;gap:8px;padding:.35rem .45rem;border:1px solid #e2c48d;border-radius:10px;background:#fffef7;cursor:pointer}
.ingredient-btn:hover{filter:brightness(.98)}
.ingredient-btn img{width:32px;height:32px;object-fit:contain}
.ingredient-btn span{font-size:.9rem}
.prep-work{display:flex;align-items:center;justify-content:center;background:#fffef7;border:2px solid var(--frame);border-radius:10px;min-height:340px}
.cookie-stage{position:relative;width:360px;height:260px;display:flex;align-items:center;justify-content:center}
.prep-cookie{width:160px;height:160px;filter:drop-shadow(0 2px 4px rgba(0,0,0,.15))}
.prep-toppings{position:absolute;inset:0;pointer-events:auto}
.prep-toppings img{position:absolute;width:36px;height:36px;cursor:pointer;transition:transform .08s}
.prep-toppings img:hover{transform:scale(1.05)}
.prep-summary .summary-box{background:#fffbee;border:1px dashed var(--frame);border-radius:10px;padding:8px;max-height:360px;overflow:auto}
.prep-list{margin:.2rem 0 .4rem;padding-left:1.1rem}
.btn.secondary{background:#ffe9b5}
.btn.secondary:hover{filter:brightness(.97)}
