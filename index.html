<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <title>Simulator BiscuiÈ›i FinKids</title>
  <style>
    /* Stiluri globale È™i fundaluri */
    body {
      margin: 0;
      font-family: 'Comic Sans MS', sans-serif;
      background-color: #fdf5e6;
    }
    #top-bar {
      background-color: #fdd26e;
      padding: 0.5rem 1rem;
      font-size: 1.2rem;
      display: flex;
      align-items: center;
    }
    #top-bar .lei-display {
      margin-left: auto;
    }
    .screen {
      display: none;
      min-height: calc(100vh - 50px);
      padding: 1rem;
      box-sizing: border-box;
      position: relative;
    }
    .active-screen {
      display: block;
    }
    .scene-shop {
      background-image: url('shop_background.png');
      background-size: cover;
      background-position: center;
    }
    .scene-kitchen {
      background-image: url('kitchen_background.png');
      background-size: cover;
      background-position: center;
    }

    /* Fundal pentru blat de lucru la etapa de mixare */
    .scene-worktop {
      background-image: url('worktop_background.png');
      background-size: cover;
      background-position: center;
    }
    .order-ticket {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      background: #fffbee;
      border: 2px solid #e6a937;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      font-weight: bold;
    }
    .client {
      font-size: 4rem;
      margin-top: 2rem;
      animation: clientEnter 1s ease forwards;
      opacity: 0;
    }
    @keyframes clientEnter {
      from { transform: translateX(-100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    .speech-bubble {
      position: absolute;
      top: 1.5rem;
      left: 6rem;
      background: #fffbee;
      border: 2px solid #e6a937;
      padding: 0.5rem;
      border-radius: 8px;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .panel {
      background-color: rgba(255, 255, 255, 0.85);
      border: 2px solid #e6a937;
      border-radius: 10px;
      padding: 1rem;
      margin-top: 2rem;
      max-width: 300px;
    }
    button {
      background-color: #f5a623;
      border: none;
      color: white;
      padding: 0.6rem 1rem;
      border-radius: 6px;
      font-size: 1rem;
      cursor: pointer;
      margin-top: 1rem;
    }
    button:hover {
      background-color: #e58b17;
    }
    .banisor {
      margin-top: 2rem;
      text-align: center;
    }
    .banisor img {
      width: 80px;
      height: 80px;
      animation: bounce 2s infinite;
    }
    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
      40% { transform: translateY(-10px); }
      60% { transform: translateY(-5px); }
    }
    /* Layout pentru ingrediente */
    /* Masa cu ingrediente pentru amestecare */
    .ingredients-board {
      position: absolute;
      left: 0;
      bottom: 12vh;
      width: 100%;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      flex-wrap: wrap;
      gap: 1rem;
    }
    .ingredient-slot {
      position: relative;
      width: 80px;
      height: 80px;
      border: 2px solid #e6a937;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.85);
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: grab;
      opacity: 0;
      animation: popIn 0.6s forwards;
    }
    .ingredient-slot.used {
      opacity: 0.4;
    }
    .ingredient-slot img {
      width: 70px;
      height: 70px;
    }
    .ingredient-name {
      text-align: center;
      font-size: 0.75rem;
      margin-top: 0.2rem;
      width: 80px;
    }
    @keyframes popIn {
      from { transform: translateY(30px) scale(0.8); opacity: 0; }
      to   { transform: translateY(0)     scale(1);   opacity: 1; }
    }
    /* Bolul pentru aluat */
    .bowl {
      /* zona de drop pentru aluat: suprapusÄƒ peste bolul ilustrat din fundal */
      position: absolute;
      /* poziÈ›ionat Ã®n jurul centrului inferior al ecranului; se adapteazÄƒ la dimensiune */
      top: 58%;
      left: 50%;
      transform: translate(-50%, -40%);
      width: 40%;
      height: 32%;
      border: 2px dashed #d3994c;
      border-bottom-left-radius: 50%;
      border-bottom-right-radius: 50%;
      background-color: rgba(249, 213, 163, 0.4);
      pointer-events: auto;
    }
    .drop-in {
      animation: drop-in 0.6s ease forwards;
    }
    @keyframes drop-in {
      from { transform: translateY(-30px) scale(0.6); opacity: 0; }
      to { transform: translateY(0) scale(1); opacity: 1; }
    }
    /* Progres bar pentru coacere */
    .progress-container {
      width: 60%;
      height: 20px;
      background: #fffbee;
      border: 2px solid #e6a937;
      border-radius: 10px;
      margin: 5rem auto;
    }
    .progress-bar {
      height: 100%;
      width: 0;
      background: #f5a623;
      border-radius: 10px;
      transition: width 0.1s;
    }
    /* Container biscuite È™i toppinguri */
    .cookie-container {
      position: relative;
      width: 200px;
      height: 200px;
      margin: 3rem auto 1rem auto;
    }
    .cookie-base {
      width: 180px;
      height: 180px;
      border-radius: 50%;
      background-color: #f5c57e;
      border: 4px solid #d3994c;
      margin: 0 auto;
    }
    .toppings-container {
      display: flex;
      justify-content: center;
      gap: 0.8rem;
      margin-top: 1rem;
    }
    .topping-img {
      width: 40px;
      height: 40px;
      cursor: grab;
    }
    /* Bara de staÈ›ii (Mixare, Coacere, Decorare) */
    .station-bar {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      display: flex;
      justify-content: center;
      gap: 2rem;
      padding: 0.5rem;
      background: #333;
      color: #fff;
      font-size: 0.9rem;
    }
    .station-bar .station {
      padding: 0.3rem 1rem;
      border-radius: 4px;
      background: #555;
    }
    .station-bar .active {
      background: #f5a623;
      color: #000;
    }
    /* Confetti */
    .confetti-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      overflow: hidden;
    }
    .confetti-piece {
      position: absolute;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      animation: confetti-fall 3s linear forwards;
    }
    @keyframes confetti-fall {
      0% { transform: translateY(-10%); opacity: 1; }
      100% { transform: translateY(110vh); opacity: 0; }
    }

    /* Clientul intrÄƒ de la uÈ™Äƒ (din dreapta) È™i merge spre tejghea */
    .client-right {
      position: absolute;
      bottom: 6rem;
      right: 3rem;
      font-size: 5rem;
      animation: clientEnterFromRight 1s forwards;
      opacity: 0;
      z-index: 10;
    }
    @keyframes clientEnterFromRight {
      from { transform: translateX(200%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    /* Banisor plasat dupÄƒ tejghea */
    .banisor-counter {
      position: absolute;
      bottom: 2rem;
      left: 2rem;
      text-align: center;
    }
    .banisor-counter img {
      width: 100px;
      height: 100px;
      animation: bounce 2s infinite;
    }
    /* Stiluri pentru animaÈ›ia cuptorului */
.oven-animation-container {
  position: relative;
  width: 400px;
  height: 300px;
  margin: 2rem auto;
}
.oven-image {
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
}
.baking-tray {
  position: absolute;
  width: 280px;
  height: 150px;
  background-color: #c0c0c0;
  border: 2px solid #8b8b8b;
  border-radius: 8px;
  display: flex;
  justify-content: center;
  align-items: center;
  /* PoziÈ›ia iniÈ›ialÄƒ a tÄƒvii */
  top: 100px;
  left: -290px;
  /* AnimaÈ›ia care dureazÄƒ 3 secunde, la fel ca timer-ul */
  animation: bake-animation 3s ease-in-out forwards;

  /* Tava este vizibilÄƒ doar cÃ¢nd uÈ™a cuptorului este deschisÄƒ; controlatÄƒ din JS */
  opacity: 1;
  transition: opacity 0.2s ease;
}
.cookie-on-tray {
  width: 100px;
  height: 100px;
}
@keyframes bake-animation {
  0% {
    /* Tava este afarÄƒ, Ã®n stÃ¢nga */
    transform: translateX(0);
  }
  20% {
    /* Tava intrÄƒ Ã®n cuptor */
    transform: translateX(410px);
  }
  80% {
    /* Tava stÄƒ Ã®n cuptor (Ã®n timpul coacerii) */
    transform: translateX(410px);
  }
  100% {
    /* Tava iese din cuptor */
    transform: translateX(0);
  }
}
  </style>
</head>
<body>
  <div id="top-bar"><span class="lei-display">ðŸ’° <span id="lei-count">0</span></span></div>
  <main id="cookie-game"></main>
  <script>
    // FuncÈ›ii de stare È™i utilitare
    function loadState() {
      try {
        const data = localStorage.getItem('cookie_profile');
        return data ? JSON.parse(data) : { lei: 0, progress: { cookies: { day: 1, profitBest: 0 } } };
      } catch (e) {
        return { lei: 0, progress: { cookies: { day: 1, profitBest: 0 } } };
      }
    }
    function saveState(s) {
      localStorage.setItem('cookie_profile', JSON.stringify(s));
    }
    let state = loadState();

// -- Variabile pentru sistemul de decizii financiare --
let financialStep = 0;
// Parametri care pot influenÈ›a profitul (simplificat)
let ingredientQuality = 2; // 1=ieftin, 2=mediu, 3=premium
let equipmentLevel = 0;    // 0=basic,1=mixer,2=cuptor electric
let priceChoice = 2;       // 1=mic,2=mediu,3=mare
let marketingLevel = 0;    // 0=none,1=mic,2=mare
let hasInsurance = false;
let loanAmount = 0;

// Definim deciziile financiare ca o listÄƒ de obiecte
const financialDecisions = [
  {
    title: 'Ce fel de ingrediente folosim?',
    description: 'Alege cu ce vrei sÄƒ faci biscuiÈ›ii. Ingrediente diferite au calitÄƒÈ›i È™i preÈ›uri diferite.',
    options: [
      {
        text: 'Ingrediente ieftine (10 lei) â€“ biscuiÈ›ii pot fi mai puÈ›in gustoÈ™i',
        effect: () => {
          state.lei -= 10;
          ingredientQuality = 1;
          alert('Ai ales ingrediente ieftine. BiscuiÈ›ii s-ar putea sÄƒ nu fie la fel de buni, dar costÄƒ mai puÈ›in.');
        }
      },
      {
        text: 'Ingrediente normale (20 lei) â€“ echilibru Ã®ntre cost È™i gust',
        effect: () => {
          state.lei -= 20;
          ingredientQuality = 2;
          alert('Ai ales ingrediente normale. BiscuiÈ›ii vor fi buni, iar costul este rezonabil.');
        }
      },
      {
        text: 'Ingrediente de calitate (30 lei) â€“ biscuiÈ›i foarte gustoÈ™i',
        effect: () => {
          state.lei -= 30;
          ingredientQuality = 3;
          alert('Ai ales ingrediente de calitate. BiscuiÈ›ii vor fi delicioÈ™i, chiar dacÄƒ ai cheltuit mai mult.');
        }
      }
    ]
  },
  {
    title: 'Ce unelte folosim?',
    description: 'Unelte mai bune ne ajutÄƒ sÄƒ facem mai mulÈ›i biscuiÈ›i. Ce alegi?',
    options: [
      {
        text: 'FÄƒrÄƒ unelte noi â€“ facem puÈ›ini biscuiÈ›i',
        effect: () => {
          equipmentLevel = 0;
          alert('Nu ai cumpÄƒrat unelte noi. Vom face doar cÃ¢È›iva biscuiÈ›i deodatÄƒ.');
        }
      },
      {
        text: 'Mixer simplu (50 lei) â€“ facem mai mult aluat',
        effect: () => {
          if (state.lei >= 50) {
            state.lei -= 50;
            equipmentLevel = 1;
            alert('Ai cumpÄƒrat un mixer simplu. Putem prepara mai mult aluat È™i mai mulÈ›i biscuiÈ›i.');
          } else {
            alert('Nu ai suficienÈ›i lei pentru mixer.');
          }
        }
      },
      {
        text: 'Cuptor electric (200 lei) â€“ coacem mulÈ›i biscuiÈ›i rapid',
        effect: () => {
          if (state.lei >= 200) {
            state.lei -= 200;
            equipmentLevel = 2;
            alert('Ai cumpÄƒrat un cuptor electric. Vom coace multe biscuiÈ›i rapid!');
          } else {
            alert('Nu ai suficienÈ›i lei pentru cuptor.');
          }
        }
      }
    ]
  },
  {
    title: 'CÃ¢t costÄƒ un biscuit?',
    description: 'PreÈ›ul trebuie sÄƒ fie potrivit pentru ca oamenii sÄƒ cumpere. Ce alegi?',
    options: [
      {
        text: 'PreÈ› mic (2 lei) â€“ vom vinde rapid, dar cÃ¢È™tigÄƒm puÈ›in',
        effect: () => {
          priceChoice = 1;
          alert('Ai ales un preÈ› mic. Vom vinde repede, dar fiecare biscuite aduce puÈ›ini lei.');
        }
      },
      {
        text: 'PreÈ› mediu (5 lei) â€“ vinde bine È™i cÃ¢È™tigÄƒm bine',
        effect: () => {
          priceChoice = 2;
          alert('Ai ales un preÈ› mediu. BiscuiÈ›ii se vor vinde bine È™i vom cÃ¢È™tiga frumos.');
        }
      },
      {
        text: 'PreÈ› mare (10 lei) â€“ puÈ›ini clienÈ›i, dar cÃ¢È™tigÄƒm mai mult pe bucatÄƒ',
        effect: () => {
          priceChoice = 3;
          alert('Ai ales un preÈ› mare. Mai puÈ›ini oameni vor cumpÄƒra, dar profitul pe biscuite creÈ™te.');
        }
      }
    ]
  },
  {
    title: 'Facem reclamÄƒ?',
    description: 'Reclama ne poate aduce clienÈ›i noi. CÃ¢t vrei sÄƒ investeÈ™ti?',
    options: [
      {
        text: 'FÄƒrÄƒ reclamÄƒ â€“ vin doar clienÈ›ii care ne cunosc',
        effect: () => {
          marketingLevel = 0;
          alert('Nu ai cheltuit pe reclamÄƒ. Oamenii care ne cunosc deja vor veni.');
        }
      },
      {
        text: 'Pliante (30 lei) â€“ atragem cÃ¢È›iva clienÈ›i noi',
        effect: () => {
          if (state.lei >= 30) {
            state.lei -= 30;
            marketingLevel = 1;
            alert('Ai tipÄƒrit pliante. Vor veni cÃ¢È›iva clienÈ›i noi.');
          } else {
            alert('Nu ai suficienÈ›i lei pentru pliante.');
          }
        }
      },
      {
        text: 'Reclame online (100 lei) â€“ atragem mulÈ›i clienÈ›i',
        effect: () => {
          if (state.lei >= 100) {
            state.lei -= 100;
            marketingLevel = 2;
            alert('Ai plÄƒtit reclame pe internet. MulÈ›i clienÈ›i vor afla de biscuiÈ›ii tÄƒi!');
          } else {
            alert('Nu ai suficienÈ›i lei pentru reclame online.');
          }
        }
      }
    ]
  },
  {
    title: 'Ce facem cu banii?',
    description: 'DupÄƒ ce vindem biscuiÈ›i, putem alege sÄƒ economisim, sÄƒ reinvestim sau sÄƒ cheltuim pe ceva pentru noi.',
    options: [
      {
        text: 'Economisim â€“ pÄƒstrÄƒm banii pentru mai tÃ¢rziu',
        effect: () => {
          const gain = Math.floor(state.lei * 0.05);
          state.lei += gain;
          alert('Ai ales sÄƒ economiseÈ™ti. Banii tÄƒi vor creÈ™te puÈ›in (cu 5%) È™i Ã®i vei avea pentru mai tÃ¢rziu.');
        }
      },
      {
        text: 'Reinvestim â€“ cumpÄƒrÄƒm mai multe ingrediente È™i unelte',
        effect: () => {
          alert('Ai ales sÄƒ reinvesteÈ™ti. Folosim banii pentru a cumpÄƒra ingrediente sau unelte ca sÄƒ cÃ¢È™tigÄƒm mai mult Ã®n viitor.');
        }
      },
      {
        text: 'CumpÄƒrÄƒm o jucÄƒrie â€“ cheltuim pentru plÄƒcerea noastrÄƒ',
        effect: () => {
          const spent = Math.min(20, state.lei);
          state.lei -= spent;
          alert('Ai ales sÄƒ cumperi o jucÄƒrie. Este distractiv acum, dar ai mai puÈ›ini bani pentru afacere.');
        }
      }
    ]
  },
  {
    title: 'Cum ne protejÄƒm de surprize?',
    description: 'Uneori se Ã®ntÃ¢mplÄƒ lucruri neprevÄƒzute (ploaie, se stricÄƒ cuptorul). Cum ne pregÄƒtim?',
    options: [
      {
        text: 'ÃŽmprumut (100 lei) â€“ avem bani acum, dar trebuie sÄƒ dÄƒm mai mult Ã®napoi',
        effect: () => {
          loanAmount += 100;
          state.lei += 100;
          alert('Ai luat un Ã®mprumut. Acum ai bani, dar va trebui sÄƒ Ã®i returnezi cu dobÃ¢ndÄƒ.');
        }
      },
      {
        text: 'Asigurare (20 lei) â€“ ne protejeazÄƒ cÃ¢nd apar probleme',
        effect: () => {
          if (state.lei >= 20) {
            state.lei -= 20;
            hasInsurance = true;
            alert('Ai cumpÄƒrat asigurare. DacÄƒ se Ã®ntÃ¢mplÄƒ ceva rÄƒu, nu pierzi toÈ›i banii.');
          } else {
            alert('Nu ai suficienÈ›i lei pentru asigurare.');
          }
        }
      },
      {
        text: 'Nu facem nimic â€“ riscÄƒm sÄƒ pierdem bani',
        effect: () => {
          alert('Nu ai ales protecÈ›ie. DacÄƒ apare un eveniment neprevÄƒzut, poÈ›i pierde bani.');
        }
      }
    ]
  }
];

// AfiÈ™eazÄƒ un ecran de decizie financiarÄƒ dupÄƒ servire
function showFinancialDecision() {
  clearGame();
  // dacÄƒ am parcurs toate deciziile, revenim la meniu È™i pregÄƒtim o nouÄƒ comandÄƒ
  if (financialStep >= financialDecisions.length) {
    financialStep = 0;
    showOrderScreen();
    return;
  }
  const dec = financialDecisions[financialStep];
  const root = document.getElementById('cookie-game');
  const screen = document.createElement('div');
  screen.className = 'screen active-screen scene-shop';
  const title = document.createElement('h2');
  title.textContent = dec.title;
  screen.appendChild(title);
  const desc = document.createElement('p');
  desc.textContent = dec.description;
  screen.appendChild(desc);
  // container pentru butoane
  dec.options.forEach(opt => {
    const btn = document.createElement('button');
    btn.textContent = opt.text;
    btn.addEventListener('click', () => {
      opt.effect();
      updateLeiDisplay();
      saveState(state);
      // trecem la urmÄƒtoarea decizie
      financialStep++;
      showFinancialDecision();
    });
    screen.appendChild(btn);
  });
  screen.appendChild(createBanisor('Alege una dintre opÈ›iuni pentru a Ã®nvÄƒÈ›a despre bani!'));
  root.appendChild(screen);
}
    function updateLeiDisplay() {
      document.getElementById('lei-count').textContent = state.lei;
    }
    function addLei(amount) {
      state.lei += amount;
      updateLeiDisplay();
      saveState(state);
    }
    function updateCookieProgress(data) {
      const prog = state.progress.cookies || {};
      state.progress.cookies = { ...prog, ...data };
      saveState(state);
    }
    // Date de joc
    const DECORATIONS = {
      'ciocolatÄƒ': { piece: 'chocolate_chips.png', final: 'cookie_choco.png' },
      'fructe':    { piece: 'strawberries.png',    final: 'cookie_strawberry.png' },
      'bombonele': { piece: 'sprinkles.png',       final: 'cookie_sprinkle.png' }
    };
    const ORDERS = [
      { decoration: 'ciocolatÄƒ' },
      { decoration: 'fructe' },
      { decoration: 'bombonele' }
    ];
    const CLIENTS = [
      { emoji: 'ðŸ‘§', name: 'Maria' },
      { emoji: 'ðŸ‘¦', name: 'Ion' },
      { emoji: 'ðŸ»', name: 'UrsuleÈ›' },
      { emoji: 'ðŸ¦Š', name: 'Vulpita' }
    ];
    let currentOrder, currentClient;
    // stocÄƒm ingrediente suplimentare adÄƒugate Ã®n aluat (cacao sau cocos)
    let currentExtras = { cacao: false, cocos: false };
    // Helper pentru curÄƒÈ›area ecranului
    function clearGame() {
      const root = document.getElementById('cookie-game');
      root.innerHTML = '';
    }
    // Bara de staÈ›ii
    function renderStationBar(active) {
      document.querySelectorAll('.station-bar').forEach(el => el.remove());
      const bar = document.createElement('div');
      bar.className = 'station-bar';
      ['Mixare', 'Coacere', 'Decorare'].forEach(name => {
        const div = document.createElement('div');
        div.className = 'station';
        div.textContent = name;
        if (name === active) div.classList.add('active');
        bar.appendChild(div);
      });
      document.body.appendChild(bar);
    }
    // Mascota Banisor
    function createBanisor(text) {
      const cont = document.createElement('div');
      cont.className = 'banisor';
      const img = document.createElement('img');
      img.src = 'banisor_character.png';
      img.alt = 'Banisor';
      cont.appendChild(img);
      const msg = document.createElement('p');
      msg.textContent = text;
      cont.appendChild(msg);
      return cont;
    }
    // AfiÈ™Äƒm ecranul de comandÄƒ
    function showOrderScreen() {
      clearGame();
      renderStationBar('');
      currentOrder = ORDERS[Math.floor(Math.random() * ORDERS.length)];
      currentClient = CLIENTS[Math.floor(Math.random() * CLIENTS.length)];
      const root = document.getElementById('cookie-game');
      const screen = document.createElement('div');
      screen.className = 'screen active-screen scene-shop';
      const orderNumber = (state.progress.cookies && state.progress.cookies.day) ? state.progress.cookies.day : 1;
      const ticket = document.createElement('div');
      ticket.className = 'order-ticket';
      ticket.textContent = 'Comanda ' + orderNumber;
      screen.appendChild(ticket);
      // Clientul intrÄƒ de la dreapta È™i se opreÈ™te Ã®n faÈ›a tejghelei
      const clientEl = document.createElement('div');
      clientEl.className = 'client-right';
      clientEl.textContent = currentClient.emoji;
      screen.appendChild(clientEl);
      // Bula de discuÈ›ie cu imaginea comenzii (poziÈ›ionatÄƒ Ã®n colÈ›ul stÃ¢nga sus)
      const bubble = document.createElement('div');
      bubble.className = 'speech-bubble';
      // RepozitionÄƒm bula cu CSS inline pentru a fi Ã®n colÈ›ul din dreapta sus
      bubble.style.position = 'absolute';
      bubble.style.top = '1rem';
      // poziÈ›ionÄƒm bula Ã®n colÈ›ul din dreapta sus pentru a nu acoperi panoul
      bubble.style.right = '1rem';
      bubble.style.left = 'auto';
      // SetÄƒm dimensiuni fixe pentru bulÄƒ ca sÄƒ nu se Ã®ntindÄƒ pe tot ecranul
      bubble.style.width = '120px';
      bubble.style.height = '80px';
      bubble.style.display = 'flex';
      bubble.style.justifyContent = 'center';
      bubble.style.alignItems = 'center';
      const oImg = document.createElement('img');
      oImg.src = DECORATIONS[currentOrder.decoration].final;
      oImg.style.width = '80px';
      oImg.style.height = '80px';
      bubble.appendChild(oImg);
      screen.appendChild(bubble);
      // Panou cu mesaj de Ã®ntÃ¢mpinare È™i explicaÈ›ie
      const panel = document.createElement('div');
      panel.className = 'panel';
      panel.innerHTML = '<strong>Bun venit la FinKids BiscuiÈ›i!</strong><br>' + currentClient.name + ' doreÈ™te un biscuite cu decor de <em>' + currentOrder.decoration + '</em>.<br>Banisor te aÈ™teaptÄƒ dupÄƒ tejghea sÄƒ Ã®i iei comanda!';
      screen.appendChild(panel);
      // Butonul pentru a Ã®ncepe etapa de mixare
      const btn = document.createElement('button');
      btn.textContent = 'IntrÄƒ Ã®n bucÄƒtÄƒrie';
      btn.addEventListener('click', showMixScreen);
      screen.appendChild(btn);
      // Banisor plasat dupÄƒ tejghea (fÄƒrÄƒ mesaj lung)
      const ban = document.createElement('div');
      ban.className = 'banisor-counter';
      const bImg = document.createElement('img');
      bImg.src = 'banisor_character.png';
      bImg.alt = 'Banisor';
      ban.appendChild(bImg);
      screen.appendChild(ban);
      root.appendChild(screen);
    }
    // Etapa de amestecare
    function showMixScreen() {
      clearGame();
      // resetÄƒm variabila globalÄƒ extras pentru o nouÄƒ comandÄƒ
      currentExtras = { cacao: false, cocos: false };
      renderStationBar('Mixare');
      const root = document.getElementById('cookie-game');
      const screen = document.createElement('div');
      // Folosim fundalul blatului de lucru pentru etapa de mixare
      screen.className = 'screen active-screen scene-worktop';
      const title = document.createElement('h2');
      title.textContent = 'PregÄƒtirea aluatului';
      const desc = document.createElement('p');
      desc.textContent = 'Trage ingredientele de pe masÄƒ Ã®n bol pentru a pregÄƒti aluatul.';
      screen.appendChild(title);
      screen.appendChild(desc);
      const bowl = document.createElement('div');
      bowl.className = 'bowl';
      let addedBase = 0;
      // È›ine evidenÈ›a ingredientelor extra adÄƒugate
      const mixExtras = { cacao: false, cocos: false };
      const baseKeys = ['faina', 'zahar', 'lapte'];
      let mixBtnShown = false;
      bowl.addEventListener('dragover', e => e.preventDefault());
      bowl.addEventListener('drop', e => {
        e.preventDefault();
        const key = e.dataTransfer.getData('text/plain');
        const item = document.querySelector('.ingredient-slot[data-key="' + key + '"]');
        if (item && !item.classList.contains('used')) {
          item.classList.add('used');
          if (baseKeys.includes(key)) addedBase++;
          if (key === 'cacao') mixExtras.cacao = true;
          if (key === 'cocos') mixExtras.cocos = true;
          const ing = ingredientsMaster.find(obj => obj.key === key);
          if (ing) {
            const dropImg = document.createElement('img');
            dropImg.src = ing.img;
            dropImg.className = 'drop-in';
            // dimensionÄƒm piesele Ã®n funcÈ›ie de dimensiunea bolului pentru a nu fi prea mari
            const rect = bowl.getBoundingClientRect();
            // dimensiunea piesei este 12% din lÄƒÈ›imea bolului, dar nu mai mult de 50px
            const size = Math.min(rect.width * 0.12, 50);
            dropImg.style.width = size + 'px';
            dropImg.style.height = size + 'px';
            // distribuim aleator imaginile Ã®n interiorul bolului
            const x = rect.width * 0.15 + Math.random() * rect.width * 0.7;
            const y = rect.height * 0.1 + Math.random() * rect.height * 0.5;
            dropImg.style.left = x + 'px';
            dropImg.style.top = y + 'px';
            bowl.appendChild(dropImg);
          }
          if (addedBase >= 3 && !mixBtnShown) {
            mixBtn.style.display = 'inline-block';
            mixBtnShown = true;
          }
        }
      });
      screen.appendChild(bowl);
      const ingredientsMaster = [
        { key: 'faina',  img: 'flour.png',   name: 'FÄƒinÄƒ' },
        { key: 'zahar',  img: 'sugar.png',   name: 'ZahÄƒr' },
        { key: 'lapte',  img: 'milk.png',    name: 'Lapte' },
        { key: 'cacao',  img: 'cacao.png',   name: 'Cacao' },
        { key: 'cocos',  img: 'coconut.png', name: 'NucÄƒ de cocos' }
      ];
      const board = document.createElement('div');
      board.className = 'ingredients-board';
      ingredientsMaster.forEach((ing, idx) => {
        // Fiecare ingredient este plasat Ã®ntr-un bol circular cu etichetÄƒ
        const slot = document.createElement('div');
        slot.className = 'ingredient-slot';
        slot.dataset.key = ing.key;
        // setÄƒm o Ã®ntÃ¢rziere a animaÈ›iei pentru efect pop-in
        slot.style.animationDelay = (idx * 0.1) + 's';
        const img = document.createElement('img');
        img.src = ing.img;
        img.alt = ing.name;
        img.setAttribute('draggable', 'true');
        img.addEventListener('dragstart', ev => {
          ev.dataTransfer.setData('text/plain', ing.key);
        });
        slot.appendChild(img);
        // etichetÄƒ ingredient
        const label = document.createElement('div');
        label.className = 'ingredient-name';
        label.textContent = ing.name;
        // container pentru slot È™i etichetÄƒ
        const wrapper = document.createElement('div');
        wrapper.style.display = 'flex';
        wrapper.style.flexDirection = 'column';
        wrapper.style.alignItems = 'center';
        wrapper.appendChild(slot);
        wrapper.appendChild(label);
        board.appendChild(wrapper);
      });
      screen.appendChild(board);
      const mixBtn = document.createElement('button');
      mixBtn.textContent = 'AmestecÄƒ aluatul È™i coace';
      // ascuns iniÈ›ial; poziÈ›ionat Ã®n partea de jos a ecranului
      mixBtn.style.display = 'none';
      mixBtn.style.position = 'absolute';
      mixBtn.style.bottom = '1.2rem';
      mixBtn.style.left = '50%';
      mixBtn.style.transform = 'translateX(-50%)';
      mixBtn.addEventListener('click', () => {
        // salvÄƒm extra Ã®n variabila globalÄƒ Ã®nainte de coacere
        currentExtras = { ...mixExtras };
        showBakeScreen();
      });
      screen.appendChild(mixBtn);
      screen.appendChild(createBanisor('AdaugÄƒ fÄƒinÄƒ, zahÄƒr, lapte È™i, dacÄƒ doreÈ™ti, cacao sau nucÄƒ de cocos.'));
      root.appendChild(screen);
    }
    // Coacerea (CU ANIMAÈšIE NOUÄ‚)
function showBakeScreen() {
  clearGame();
  renderStationBar('Coacere');
  const root = document.getElementById('cookie-game');
  const screen = document.createElement('div');
  // FoloseÈ™te scena de bucÄƒtÄƒrie pentru coacere
  screen.className = 'screen active-screen scene-kitchen';
  
  const title = document.createElement('h2');
  title.textContent = 'Coacerea biscuitului';
  screen.appendChild(title);

  // --- Noul container pentru animaÈ›ia cuptorului ---
  const ovenContainer = document.createElement('div');
  ovenContainer.className = 'oven-animation-container';

  // Imaginea cuptorului: pornim cu varianta cu uÈ™a deschisÄƒ
  const ovenImg = document.createElement('img');
  ovenImg.src = 'oven_open.png';
  ovenImg.alt = 'Cuptor';
  ovenImg.className = 'oven-image';
  ovenContainer.appendChild(ovenImg);

  // Tava care va fi animatÄƒ
  const tray = document.createElement('div');
  tray.className = 'baking-tray';
  
  // Imaginea biscuitului de pe tavÄƒ
  const cookieImg = document.createElement('img');
  // PÄƒstrÄƒm logica pentru a alege imaginea corectÄƒ a biscuitului
  let bakeSrc = 'cookie_bake_plain.png';
  if (currentExtras.cacao) bakeSrc = 'cookie_bake_cacao.png';
  if (currentExtras.cocos) bakeSrc = 'cookie_bake_cocos.png';
  cookieImg.src = bakeSrc;
  cookieImg.alt = 'Biscuite pe tavÄƒ';
  cookieImg.className = 'cookie-on-tray';
  tray.appendChild(cookieImg);
  ovenContainer.appendChild(tray);

  screen.appendChild(ovenContainer);
  // --- SfÃ¢rÈ™itul containerului de animaÈ›ie ---

  // barÄƒ de progres pentru coacere
  const prog = document.createElement('div');
  prog.className = 'progress-container';
  const bar = document.createElement('div');
  bar.className = 'progress-bar';
  prog.appendChild(bar);
  screen.appendChild(prog);
  
  screen.appendChild(createBanisor('AÈ™teaptÄƒ puÈ›in pÃ¢nÄƒ se coace biscuitele.'));
  root.appendChild(screen);
  
  let elapsed = 0;
  // Timer-ul de 3 secunde este pÄƒstrat pentru a se sincroniza cu animaÈ›ia
  const timer = setInterval(() => {
    elapsed += 100;
    bar.style.width = Math.min(100, (elapsed / 3000) * 100) + '%';
    if (elapsed >= 3000) {
      clearInterval(timer);
      showDecorateScreen();
    }
  }, 100);

  // SchimbÄƒm imaginea cuptorului pentru a simula Ã®nchiderea È™i deschiderea uÈ™ii
  // UÈ™a se Ã®nchide la 0.6s dupÄƒ start (20% din 3s), apoi se redeschide cÄƒtre final
  setTimeout(() => { ovenImg.src = 'oven_closed.png'; }, 600);
  setTimeout(() => { ovenImg.src = 'oven_open.png'; }, 2400);

  // ControlÄƒm vizibilitatea tÄƒvii: dispare cÃ¢nd uÈ™a este Ã®nchisÄƒ È™i reapare cÃ¢nd uÈ™a se redeschide
  setTimeout(() => { tray.style.opacity = '0'; }, 600);
  setTimeout(() => { tray.style.opacity = '1'; }, 2400);
}

    // Decorarea
    function showDecorateScreen() {
      clearGame();
      renderStationBar('Decorare');
      const root = document.getElementById('cookie-game');
      const screen = document.createElement('div');
      screen.className = 'screen active-screen scene-kitchen';
      const title = document.createElement('h2');
      title.textContent = 'Ornarea biscuitului';
      const desc = document.createElement('p');
      desc.textContent = 'Trage decoraÈ›iunile pe biscuite.';
      screen.appendChild(title);
      screen.appendChild(desc);
      const cookieContainer = document.createElement('div');
      cookieContainer.className = 'cookie-container';
      const cookieBase = document.createElement('div');
      cookieBase.className = 'cookie-base';
      cookieContainer.appendChild(cookieBase);
      const dropZone = document.createElement('div');
      dropZone.style.position = 'absolute';
      dropZone.style.top = '0';
      dropZone.style.left = '0';
      dropZone.style.width = '100%';
      dropZone.style.height = '100%';
      cookieContainer.appendChild(dropZone);
      let pieces = 0;
      let serveBtn;
      dropZone.addEventListener('dragover', e => e.preventDefault());
      dropZone.addEventListener('drop', e => {
        e.preventDefault();
        const decor = e.dataTransfer.getData('text/plain');
        // verificÄƒm dacÄƒ decorul tras este cel corect
        if (decor === currentOrder.decoration) {
          // adÄƒugÄƒm o singurÄƒ piesÄƒ Ã®n centrul biscuitului
          const part = document.createElement('img');
          part.src = DECORATIONS[currentOrder.decoration].piece;
          part.className = 'topping-img';
          part.style.position = 'absolute';
          // centrÄƒm imaginea de topping pe biscuite (180px baza, 30px topping)
          part.style.left = '75px';
          part.style.top = '75px';
          part.style.width = '30px';
          part.style.height = '30px';
          cookieContainer.appendChild(part);
          pieces++;
          // dupÄƒ o singurÄƒ piesÄƒ, afiÈ™Äƒm biscuitele final È™i butonul de servire
          if (pieces >= 1) {
            setTimeout(() => {
              cookieContainer.innerHTML = '';
              const finalImg = document.createElement('img');
              finalImg.src = DECORATIONS[currentOrder.decoration].final;
              finalImg.style.width = '180px';
              finalImg.style.height = '180px';
              finalImg.style.borderRadius = '50%';
              cookieContainer.appendChild(finalImg);
              serveBtn.style.display = 'inline-block';
            }, 500);
          }
        } else {
          alert('Acest decor nu corespunde comenzii!');
        }
      });
      screen.appendChild(cookieContainer);
      const toppings = document.createElement('div');
      toppings.className = 'toppings-container';
      // generÄƒm o singurÄƒ imagine de topping de tras Ã®n bol
      const t = document.createElement('img');
      t.src = DECORATIONS[currentOrder.decoration].piece;
      t.className = 'topping-img';
      t.setAttribute('draggable', 'true');
      t.addEventListener('dragstart', ev => {
        ev.dataTransfer.setData('text/plain', currentOrder.decoration);
      });
      toppings.appendChild(t);
      screen.appendChild(toppings);
      serveBtn = document.createElement('button');
      serveBtn.textContent = 'ServeÈ™te biscuitele';
      serveBtn.style.display = 'none';
      serveBtn.addEventListener('click', showServeScreen);
      screen.appendChild(serveBtn);
      screen.appendChild(createBanisor('DecoreazÄƒ cu grijÄƒ biscuitele. FoloseÈ™te cinci bucÄƒÈ›i.'));
      root.appendChild(screen);
    }
    // Servirea
    function showServeScreen() {
      clearGame();
      document.querySelectorAll('.station-bar').forEach(el => el.remove());
      const root = document.getElementById('cookie-game');
      const screen = document.createElement('div');
      screen.className = 'screen active-screen scene-shop';
      const title = document.createElement('h2');
      title.textContent = 'Livrarea biscuitului';
      const msg = document.createElement('p');
      msg.textContent = currentClient.name + ' a primit biscuitele È™i este foarte fericit!';
      screen.appendChild(title);
      screen.appendChild(msg);
      const finalImg = document.createElement('img');
      finalImg.src = DECORATIONS[currentOrder.decoration].final;
      finalImg.style.width = '180px';
      finalImg.style.height = '180px';
      finalImg.style.borderRadius = '50%';
      screen.appendChild(finalImg);
      // DÄƒm o recompensÄƒ mai micÄƒ (3 lei) pentru a Ã®ncuraja investiÈ›iile ulterioare
      addLei(3);
      const nextDay = (state.progress.cookies.day || 1) + 1;
      // actualizÄƒm cel mai bun profit cu noua valoare de 3 lei dacÄƒ este mai mare
      const best = Math.max(state.progress.cookies.profitBest || 0, 3);
      updateCookieProgress({ day: nextDay, profitBest: best });
      const panel = document.createElement('div');
      panel.className = 'panel';
      panel.innerHTML = '<strong>Rezumat:</strong><br>Mixare: <span style="color:#d87b00">100%</span><br>Coacere: <span style="color:#d87b00">100%</span><br>Decorare: <span style="color:#d87b00">100%</span><br><br>Total lei: <span style="color:#d87b00">' + state.lei + '</span>';
      screen.appendChild(panel);
      const againBtn = document.createElement('button');
      againBtn.textContent = 'PreparÄƒ alt biscuit';
      againBtn.addEventListener('click', showOrderScreen);
      const exitBtn = document.createElement('button');
      exitBtn.textContent = 'ÃŽnchide jocul';
      exitBtn.addEventListener('click', () => { alert('MulÈ›umim cÄƒ ai jucat! ÃŽnchide fila pentru a ieÈ™i.'); });
      screen.appendChild(againBtn);
      screen.appendChild(exitBtn);
      screen.appendChild(createBanisor('Bravo! Ai fÄƒcut un biscuite delicios!'));
      root.appendChild(screen);
      createConfetti();
      // DupÄƒ servire, prezentÄƒm o decizie financiarÄƒ pentru educaÈ›ie
      setTimeout(() => {
        showFinancialDecision();
      }, 500); // lÄƒsÄƒm puÈ›in timp pentru confetti
    }
    // Confetti
    function createConfetti() {
      const colors = ['#f9c74f', '#f9844a', '#90be6d', '#fda65f', '#87b6e5', '#f27ba5'];
      const container = document.createElement('div');
      container.className = 'confetti-container';
      for (let i = 0; i < 40; i++) {
        const piece = document.createElement('div');
        piece.className = 'confetti-piece';
        piece.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        piece.style.left = Math.random() * 100 + '%';
        piece.style.animationDelay = (Math.random() * 0.5) + 's';
        container.appendChild(piece);
      }
      document.body.appendChild(container);
      setTimeout(() => {
        if (document.body.contains(container)) document.body.removeChild(container);
      }, 3000);
    }
    // Pornim jocul dupÄƒ Ã®ncÄƒrcarea paginii
    window.addEventListener('DOMContentLoaded', () => {
      updateLeiDisplay();
      showOrderScreen();
    });
  </script>
</body>
</html>